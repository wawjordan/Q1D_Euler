module test_speed_of_sound

  use set_precision,   only : prec
  use fluid_constants, only : gamma
  use pfunit_mod

  implicit none

  real(prec), parameter :: toler = 1.0e-14_prec

  contains

  @test
    subroutine speed_of_sound_test

      real(prec) :: a, a_expected, pressure, rho
      continue

      pressure = 101325.0_prec
      rho = 1.225_prec
      a_expected = 340.29399054347107_prec
      write(*,*) gamma
      a = speed_of_sound( pressure, rho )

      write(*,*)
      write(*,*) 'a     = ', a
      write(*,*) 'a_exp = ', a_expected
      write(*,*) 'toler = ', toler
      @assertequal(1.0_prec,a/a_expected,toler)
    
    end subroutine speed_of_sound_test

    include 'speed_of_sound.f90'

end module test_speed_of_sound
